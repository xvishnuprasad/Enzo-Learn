<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book-Themed Pattern Challenge</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Open+Sans:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            min-height: 100vh;
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            font-family: 'Open Sans', sans-serif;
        }
        
        .game-wrapper {
            width: 100%;
            max-width: 900px;
            background-color: #FFF8ED;
            border: 3px solid #9370DB;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            position: relative;
        }
        
        /* Book decorative elements */
        .book-decor {
            position: absolute;
            z-index: 0;
        }
        
        .book-top-left {
            top: 30px;
            left: 30px;
            width: 120px;
            height: 100px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 100"><rect x="5" y="10" width="25" height="80" fill="%236B99C3" stroke="%23333" stroke-width="1"/><rect x="35" y="20" width="60" height="70" fill="%23D77A7A" stroke="%23333" stroke-width="1"/><rect x="45" y="30" width="40" height="40" fill="none" stroke="%23fff" stroke-width="1"/><rect x="10" y="20" width="15" height="60" fill="none" stroke="%23fff" stroke-width="1"/></svg>') no-repeat;
        }
        
        .book-top-right {
            top: 30px;
            right: 30px;
            width: 150px;
            height: 100px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 100"><rect x="5" y="10" width="35" height="80" fill="%236B99C3" stroke="%23333" stroke-width="1"/><rect x="45" y="15" width="30" height="75" fill="%23D77A7A" stroke="%23333" stroke-width="1"/><rect x="75" y="20" width="40" height="70" fill="%236B99C3" stroke="%23333" stroke-width="1"/><rect x="115" y="30" width="15" height="60" fill="%23F5D76E" stroke="%23333" stroke-width="1"/><line x1="55" y1="15" x2="55" y2="90" stroke="%23fff" stroke-width="1"/><line x1="20" y1="50" x2="20" y2="70" stroke="%23fff" stroke-width="1"/><polygon points="20,40 30,40 20,50" fill="%23fff"/></svg>') no-repeat;
        }
        
        .book-bottom-left {
            bottom: 30px;
            left: 30px;
            width: 150px;
            height: 100px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 100"><rect x="5" y="10" width="50" height="30" fill="%236B99C3" stroke="%23333" stroke-width="1"/><rect x="5" y="40" width="50" height="10" fill="%23D77A7A" stroke="%23333" stroke-width="1"/><rect x="5" y="50" width="50" height="30" fill="%236B99C3" stroke="%23333" stroke-width="1"/><path d="M60,20 L120,30 L120,80 L60,70 Z" fill="%23f0f0f0" stroke="%23999" stroke-width="1"/><line x1="70" y1="35" x2="110" y2="40" stroke="%23D77A7A" stroke-width="1"/><line x1="70" y1="45" x2="110" y2="50" stroke="%23D77A7A" stroke-width="1"/><line x1="70" y1="55" x2="110" y2="60" stroke="%23D77A7A" stroke-width="1"/></svg>') no-repeat;
        }
        
        .book-bottom-right {
            bottom: 30px;
            right: 30px;
            width: 150px;
            height: 100px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 100"><path d="M10,20 L140,20 L140,30 L75,65 L10,30 Z" fill="%236B99C3" stroke="%23333" stroke-width="1"/><path d="M75,65 L75,90 L140,55 L140,30 Z" fill="%236B99C3" stroke="%23333" stroke-width="1"/><path d="M10,30 L75,65 L75,90 L10,55 Z" fill="%236B99C3" stroke="%23333" stroke-width="1"/><line x1="30" y1="40" x2="120" y2="40" stroke="%23D77A7A" stroke-width="1"/><line x1="30" y1="50" x2="120" y2="50" stroke="%23D77A7A" stroke-width="1"/><line x1="30" y1="60" x2="120" y2="60" stroke="%23D77A7A" stroke-width="1"/><rect x="50" y="45" width="10" height="5" fill="%23F5D76E" stroke="%23333" stroke-width="0.5"/><rect x="100" y="55" width="10" height="5" fill="%23F5D76E" stroke="%23333" stroke-width="0.5"/></svg>') no-repeat;
        }
        
        .game-content {
            position: relative;
            z-index: 1;
            text-align: center;
            padding: 20px 0;
        }
        
        .game-title {
            margin-bottom: 30px;
        }
        
        .game-title h1 {
            font-family: 'Merriweather', serif;
            font-size: 36px;
            font-weight: 700;
            color: #6B4226;
            margin-bottom: 8px;
        }
        
        .game-title p {
            font-size: 18px;
            color: #6B4226;
            font-style: italic;
        }
        
        .level-indicator {
            display: inline-block;
            background-color: #6B99C3;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            animation: pulse 2s infinite ease-in-out;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pattern-display {
            background-color: #FFFFFF;
            border: 2px solid #D77A7A;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .pattern-title {
            font-family: 'Merriweather', serif;
            font-size: 22px;
            font-weight: 700;
            color: #6B4226;
            margin-bottom: 20px;
        }
        
        .pattern-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .pattern-item {
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            background-color: #FFF8ED;
            border: 2px solid #6B99C3;
            border-radius: 8px;
        }
        
        .empty-slot {
            width: 70px;
            height: 70px;
            border: 2px dashed #D77A7A;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            background-color: #FFF8ED;
            color: #D77A7A;
        }
        
        .options-section {
            width: 100%;
            text-align: center;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .options-title {
            font-family: 'Merriweather', serif;
            font-size: 22px;
            font-weight: 700;
            color: #6B4226;
            margin-bottom: 20px;
        }
        
        .options-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .option {
            width: 70px;
            height: 70px;
            background-color: #6B99C3;
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            cursor: grab;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .option:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }
        
        .message {
            font-size: 20px;
            font-weight: 600;
            min-height: 30px;
            margin: 20px 0;
            color: #6B4226;
        }
        
        .next-btn {
            background-color: #D77A7A;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 30px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            margin-top: 10px;
            display: none;
        }
        
        .next-btn:hover {
            background-color: #C56666;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .level-complete {
            display: none;
            background-color: rgba(255, 248, 237, 0.95);
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .level-complete h2 {
            font-family: 'Merriweather', serif;
            font-size: 32px;
            color: #6B4226;
            margin-bottom: 20px;
        }
        
        .level-complete p {
            font-size: 20px;
            color: #6B4226;
            margin-bottom: 30px;
            max-width: 80%;
        }
        
        .level-btn {
            background-color: #6B99C3;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px 35px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }
        
        .level-btn:hover {
            background-color: #5A88B2;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .progress-container {
            width: 100%;
            max-width: 700px;
            margin: 30px auto 0;
            display: flex;
            align-items: center;
        }
        
        .progress-label {
            font-size: 16px;
            font-weight: 600;
            color: #6B4226;
            margin-right: 15px;
            min-width: 120px;
            text-align: left;
        }
        
        .progress-bar {
            flex-grow: 1;
            height: 12px;
            background-color: #F0E6D2;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #6B99C3;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 6px;
        }
        
        .progress-markers {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 2%;
        }
        
        .marker {
            position: relative;
            width: 4px;
            height: 16px;
            top: -2px;
            background-color: rgba(107, 66, 38, 0.3);
            border-radius: 2px;
        }
        
        /* Animations */
        @keyframes flash {
            0% { background-color: #FFF8ED; }
            50% { background-color: #F5D76E; }
            100% { background-color: #FFF8ED; }
        }
        
        .flash-animation {
            animation: flash 0.4s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .game-wrapper {
                padding: 15px;
            }
            
            .book-decor {
                display: none;
            }
            
            .game-title h1 {
                font-size: 28px;
            }
            
            .pattern-display, .options-section {
                padding: 15px;
            }
            
            .pattern-item, .empty-slot, .option {
                width: 60px;
                height: 60px;
                font-size: 30px;
            }
        }
        
        @media (max-width: 480px) {
            .pattern-item, .empty-slot, .option {
                width: 50px;
                height: 50px;
                font-size: 24px;
            }
            
            .options-container {
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="game-wrapper">
        <!-- Book decorative elements -->
        <div class="book-decor book-top-left"></div>
        <div class="book-decor book-top-right"></div>
        <div class="book-decor book-bottom-left"></div>
        <div class="book-decor book-bottom-right"></div>
        
        <!-- Game content -->
        <div class="game-content">
            <div class="game-title">
                <h1>Pattern Challenge</h1>
                <p>Complete each pattern by dragging the correct answer</p>
            </div>
            
            <div class="level-indicator" id="levelIndicator">Level 1: Basic Patterns</div>
            
            <div class="pattern-display">
                <div class="pattern-title">Find the Missing Element</div>
                <div class="pattern-container" id="patternContainer">
                    <!-- Pattern will be dynamically inserted here -->
                </div>
            </div>
            
            <div class="options-section">
                <div class="options-title">Choose Your Answer</div>
                <div class="options-container" id="optionsContainer">
                    <!-- Options will be dynamically inserted here -->
                </div>
                <p class="message" id="message"></p>
                <button class="next-btn" id="nextBtn">Next Pattern</button>
            </div>
            
            <div class="progress-container">
                <div class="progress-label" id="progressLabel">Level Progress:</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                    <div class="progress-markers">
                        <div class="marker"></div>
                        <div class="marker"></div>
                        <div class="marker"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Level Complete Screen (initially hidden) -->
        <div class="level-complete" id="levelComplete" style="display: none;">
            <h2 id="levelCompleteTitle">Level 1 Complete!</h2>
            <p id="levelCompleteMessage">Congratulations! You've mastered the basic patterns. Ready for some more challenging patterns?</p>
            <button class="level-btn" id="nextLevelBtn">Start Level 2</button>
        </div>
        
        <!-- Game Complete Screen (initially hidden) -->
        <div class="level-complete" id="gameComplete" style="display: none;">
            <h2>Game Complete!</h2>
            <p>Congratulations! You've completed all patterns and mastered the Pattern Challenge!</p>
            <button class="level-btn" id="restartBtn">Play Again</button>
        </div>
    </div>

    <script>
        // Define different patterns for the game, organized by levels
        const levelPatterns = [
            // Level 1 - Basic Patterns
            [
                {
                    pattern: ['🌸', '🌼', '?', '🌸', '🌼'],
                    options: ['🌷', '🌻', '🌸'],
                    answer: '🌸'
                },
                {
                    pattern: ['🍎', '🍌', '🍎', '?', '🍎'],
                    options: ['🍌', '🍊', '🍇'],
                    answer: '🍌'
                },
                {
                    pattern: ['🐶', '🐱', '🐶', '🐱', '?'],
                    options: ['🐹', '🐶', '🐰'],
                    answer: '🐶'
                },
                {
                    pattern: ['🚗', '🚲', '🚗', '?', '🚗'],
                    options: ['🚲', '🚁', '🚢'],
                    answer: '🚲'
                }
            ],
            // Level 2 - Intermediate Patterns
            [
                {
                    pattern: ['⭐', '🌙', '⭐', '🌙', '?'],
                    options: ['☀', '⭐', '🌈'],
                    answer: '⭐'
                },
                {
                    pattern: ['🔴', '🔵', '?', '🔴', '🔵'],
                    options: ['🟢', '🟣', '🔴'],
                    answer: '🔴'
                },
                {
                    pattern: ['📚', '✏️', '📚', '✏️', '?'],
                    options: ['📖', '📚', '🖋️'],
                    answer: '📚'
                },
                {
                    pattern: ['🔢', '🔡', '?', '🔢', '🔡'],
                    options: ['🔠', '🔢', '🔣'],
                    answer: '🔢'
                }
            ],
            // Level 3 - Advanced Patterns
            [
                {
                    pattern: ['🟥', '🟧', '🟨', '?', '🟦'],
                    options: ['🟧', '🟩', '🟪'],
                    answer: '🟩'
                },
                {
                    pattern: ['📕', '📗', '📘', '?'],
                    options: ['📕', '📙', '📔'],
                    answer: '📙'
                },
                {
                    pattern: ['A', 'B', 'C', '?', 'E'],
                    options: ['F', 'D', 'G'],
                    answer: 'D'
                },
                {
                    pattern: ['1', '3', '5', '?', '9'],
                    options: ['6', '7', '8'],
                    answer: '7'
                }
            ]
        ];

        const levelNames = [
            "Level 1: Basic Patterns",
            "Level 2: Intermediate Patterns",
            "Level 3: Advanced Patterns"
        ];

        let currentLevel = 0;
        let currentPatternIndex = 0;
        let levelCorrect = 0;
        let totalCorrect = 0;
        
        const patternContainer = document.getElementById("patternContainer");
        const optionsContainer = document.getElementById("optionsContainer");
        const message = document.getElementById("message");
        const nextBtn = document.getElementById("nextBtn");
        const progressFill = document.getElementById("progressFill");
        const progressLabel = document.getElementById("progressLabel");
        const levelIndicator = document.getElementById("levelIndicator");
        const levelComplete = document.getElementById("levelComplete");
        const levelCompleteTitle = document.getElementById("levelCompleteTitle");
        const levelCompleteMessage = document.getElementById("levelCompleteMessage");
        const nextLevelBtn = document.getElementById("nextLevelBtn");
        const gameComplete = document.getElementById("gameComplete");
        const restartBtn = document.getElementById("restartBtn");

        // Function to load a pattern
        function loadPattern(levelIndex, patternIndex) {
            // Clear previous pattern and options
            patternContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            message.textContent = '';
            nextBtn.style.display = 'none';
            
            // Update level indicator
            levelIndicator.textContent = levelNames[levelIndex];
            
            const currentSet = levelPatterns[levelIndex][patternIndex];
            
            // Create pattern items
            currentSet.pattern.forEach(item => {
                if (item === '?') {
                    const emptySlot = document.createElement('div');
                    emptySlot.className = 'empty-slot';
                    emptySlot.id = 'slot';
                    emptySlot.textContent = '?';
                    patternContainer.appendChild(emptySlot);
                } else {
                    const patternItem = document.createElement('div');
                    patternItem.className = 'pattern-item';
                    patternItem.textContent = item;
                    patternContainer.appendChild(patternItem);
                }
            });
            
            // Create options
            currentSet.options.forEach(option => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.draggable = true;
                optionDiv.textContent = option;
                optionsContainer.appendChild(optionDiv);
            });
            
            // Set up drag and drop
            const slot = document.getElementById("slot");
            const options = document.querySelectorAll(".option");
            
            options.forEach(option => {
                option.addEventListener("dragstart", (event) => {
                    event.dataTransfer.setData("text", event.target.textContent);
                });
                
                // Add click handler for mobile users
                option.addEventListener("click", function() {
                    const optionText = this.textContent;
                    checkAnswer(optionText, slot);
                });
                
                // Add touch support for mobile drag and drop
                option.addEventListener("touchstart", function(e) {
                    e.preventDefault();
                    const optionText = this.textContent;
                    
                    // Create a touch drag effect
                    document.addEventListener("touchmove", function(e) {
                        e.preventDefault();
                    }, { passive: false });
                    
                    document.addEventListener("touchend", function handler(e) {
                        const touch = e.changedTouches[0];
                        const slot = document.getElementById("slot");
                        const slotRect = slot.getBoundingClientRect();
                        
                        if (touch.clientX > slotRect.left && touch.clientX < slotRect.right &&
                            touch.clientY > slotRect.top && touch.clientY < slotRect.bottom) {
                            checkAnswer(optionText, slot);
                        }
                        
                        document.removeEventListener("touchend", handler);
                        document.removeEventListener("touchmove", function(e) {
                            e.preventDefault();
                        });
                    });
                });
            });
            
            slot.addEventListener("dragover", (event) => {
                event.preventDefault();
            });
            
            slot.addEventListener("drop", (event) => {
                event.preventDefault();
                const droppedEmoji = event.dataTransfer.getData("text");
                checkAnswer(droppedEmoji, slot);
            });
        }
        
        // Function to check if answer is correct
        function checkAnswer(answer, slot) {
            const currentSet = levelPatterns[currentLevel][currentPatternIndex];
            
            if (answer === currentSet.answer) {
                slot.textContent = answer;
                slot.style.backgroundColor = "#F0F7E6";
                slot.style.borderStyle = "solid";
                slot.style.borderColor = "#6B99C3";
                slot.classList.add("flash-animation");
                message.textContent = "Correct! You've completed the pattern!";
                message.style.color = "#446644";
                nextBtn.style.display = 'block';
                levelCorrect++;
                totalCorrect++;
                updateProgress();
            } else {
                message.textContent = "Try again with a different option!";
                message.style.color = "#D77A7A";
                slot.classList.add("flash-animation");
                setTimeout(() => {
                    slot.classList.remove("flash-animation");
                }, 400);
            }
        }
        
        // Update progress bar
        function updateProgress() {
            // Update level progress
            const levelProgress = (levelCorrect / levelPatterns[currentLevel].length) * 100;
            progressFill.style.width = `${levelProgress}%`;
            
            // Update progress label
            progressLabel.textContent = `Level ${currentLevel + 1} Progress:`;
        }
        
        // Check if level is complete
        function checkLevelComplete() {
            if (currentPatternIndex >= levelPatterns[currentLevel].length - 1) {
                // Level complete
                if (currentLevel < levelPatterns.length - 1) {
                    // Show level complete screen
                    levelCompleteTitle.textContent = `Level ${currentLevel + 1} Complete!`;
                    
                    if (currentLevel === 0) {
                        levelCompleteMessage.textContent = "Congratulations! You've mastered the basic patterns. Ready for some more challenging patterns?";
                        nextLevelBtn.textContent = "Start Level 2";
                    } else if (currentLevel === 1) {
                        levelCompleteMessage.textContent = "Great job! You've mastered the intermediate patterns. Get ready for the final level with advanced patterns!";
                        nextLevelBtn.textContent = "Start Level 3";
                    }
                    
                    setTimeout(() => {
                        levelComplete.style.display = "flex";
                        levelComplete.classList.add("fade-in");
                    }, 500);
                } else {
                    // Game complete!
                    setTimeout(() => {
                        gameComplete.style.display = "flex";
                        gameComplete.classList.add("fade-in");
                    }, 500);
                }
            } else {
                // Go to next pattern in current level
                currentPatternIndex++;
                loadPattern(currentLevel, currentPatternIndex);
            }
        }
        
        // Next level button
        nextLevelBtn.addEventListener("click", () => {
            levelComplete.style.display = "none";
            currentLevel++;
            currentPatternIndex = 0;
            levelCorrect = 0;
            loadPattern(currentLevel, currentPatternIndex);
        });
        
        // Next pattern button
        nextBtn.addEventListener("click", () => {
            checkLevelComplete();
        });
        
        // Restart button
        restartBtn.addEventListener("click", () => {
            gameComplete.style.display = "none";
            currentLevel = 0;
            currentPatternIndex = 0;
            levelCorrect = 0;
            totalCorrect = 0;
            loadPattern(currentLevel, currentPatternIndex);
        });
        
        // Load the first pattern
        loadPattern(currentLevel, currentPatternIndex);
    </script>
</body>
</html>